<!-- frontend/src/app/shared/components/navbar/navbar.component.html -->
<nav class="navbar" *ngIf="currentUser">
  <div class="navbar-container">
    <!-- Logo & Brand -->
    <div class="navbar-brand">
      <img src="assets/logo.png" alt="LivraXpress" class="navbar-logo">
      <span class="navbar-title">LivraXpress</span>
      <span class="navbar-role-badge">{{ currentUser.role }}</span>
    </div>

    <!-- Navigation Links -->
    <div class="navbar-menu">
      <a 
        [routerLink]="['/' + currentUser.role + '/dashboard']" 
        routerLinkActive="active"
        class="nav-link"
      >
        <i class="icon-home"></i>
        <span>Tableau de bord</span>
      </a>

      <a 
        *ngIf="currentUser.role === 'client'"
        [routerLink]="['/' + currentUser.role + '/commandes']" 
        routerLinkActive="active"
        class="nav-link"
      >
        <i class="icon-shopping"></i>
        <span>Mes commandes</span>
      </a>

      <a 
        *ngIf="currentUser.role === 'fournisseur'"
        [routerLink]="['/' + currentUser.role + '/produits']" 
        routerLinkActive="active"
        class="nav-link"
      >
        <i class="icon-package"></i>
        <span>Produits</span>
      </a>

      <a 
        *ngIf="currentUser.role === 'livreur'"
        [routerLink]="['/' + currentUser.role + '/livraisons']" 
        routerLinkActive="active"
        class="nav-link"
      >
        <i class="icon-truck"></i>
        <span>Livraisons</span>
      </a>

      <a 
        *ngIf="currentUser.role === 'admin'"
        [routerLink]="['/' + currentUser.role + '/utilisateurs']" 
        routerLinkActive="active"
        class="nav-link"
      >
        <i class="icon-users"></i>
        <span>Utilisateurs</span>
      </a>
    </div>

    <!-- Right Side -->
    <div class="navbar-actions">
      <!-- Notifications -->
      <div class="notification-wrapper">
        <button 
          class="icon-button" 
          (click)="toggleNotifications()"
          [class.active]="showNotifications"
        >
          <i class="icon-bell"></i>
          <span class="notification-badge" *ngIf="unreadCount > 0">
            {{ unreadCount > 99 ? '99+' : unreadCount }}
          </span>
        </button>

        <!-- Dropdown Notifications -->
        <div class="notification-dropdown" *ngIf="showNotifications">
          <div class="dropdown-header">
            <h3>Notifications</h3>
            <span class="notification-count">{{ unreadCount }} non lue(s)</span>
          </div>

          <div class="notifications-list">
            <div 
              *ngFor="let notif of notifications"
              class="notification-item"
              [class.unread]="!notif.lu"
              (click)="navigateToNotification(notif)"
            >
              <div class="notification-icon">{{ getNotificationIcon(notif.type) }}</div>
              <div class="notification-content">
                <div class="notification-title">{{ notif.titre }}</div>
                <div class="notification-message">{{ notif.message }}</div>
                <div class="notification-time">{{ getTimeAgo(notif.date_creation) }}</div>
              </div>
              <button 
                *ngIf="!notif.lu"
                class="mark-read-btn"
                (click)="markAsRead(notif.id, $event)"
                title="Marquer comme lu"
              >
                <i class="icon-check"></i>
              </button>
            </div>

            <div *ngIf="notifications.length === 0" class="no-notifications">
              <i class="icon-bell-off"></i>
              <p>Aucune notification</p>
            </div>
          </div>

          <div class="dropdown-footer">
            <button class="view-all-btn" (click)="viewAllNotifications()">
              Voir toutes les notifications
            </button>
          </div>
        </div>
      </div>

      <!-- User Menu -->
      <div class="user-wrapper">
        <button 
          class="user-button" 
          (click)="toggleUserMenu()"
          [class.active]="showUserMenu"
        >
          <img 
            [src]="currentUser.photo_profil" 
            [alt]="currentUser.nom_complet"
            class="user-avatar"
          >
          <div class="user-info">
            <span class="user-name">{{ currentUser.nom_complet }}</span>
            <span class="user-email">{{ currentUser.email }}</span>
          </div>
          <i class="icon-chevron-down"></i>
        </button>

        <!-- Dropdown User Menu -->
        <div class="user-dropdown" *ngIf="showUserMenu">
          <a 
            [routerLink]="['/' + currentUser.role + '/profil']" 
            class="dropdown-item"
            (click)="showUserMenu = false"
          >
            <i class="icon-user"></i>
            <span>Mon profil</span>
          </a>
          
          <a 
            [routerLink]="['/' + currentUser.role + '/parametres']" 
            class="dropdown-item"
            (click)="showUserMenu = false"
          >
            <i class="icon-settings"></i>
            <span>Paramètres</span>
          </a>
          
          <div class="dropdown-divider"></div>
          
          <button class="dropdown-item logout-item" (click)="logout()">
            <i class="icon-logout"></i>
            <span>Déconnexion</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- Overlay pour fermer les dropdowns -->
<div 
  class="dropdown-overlay" 
  *ngIf="showNotifications || showUserMenu"
  (click)="showNotifications = false; showUserMenu = false"
></div>